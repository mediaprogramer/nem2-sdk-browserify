<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
<title>070_aggregate_sample</title>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://unpkg.com/rxjs/bundles/rxjs.umd.min.js"></script>
<script src="https://s3-ap-northeast-1.amazonaws.com/xembook.net/nem2-sdk/nem2-sdk-0.11.6.js"></script>
<script>

/*
{"meta":{"height":[530298,0],"hash":"C3BBA41B284BF291B4FC73AA914BC5E619F7C9B7C3F56F362F877276BD00A245","merkleComponentHash":"C3BBA41B284BF291B4FC73AA914BC5E619F7C9B7C3F56F362F877276BD00A245","index":0,"id":"5D00697B28174C00014569CF"},"transaction":{"signature":"3573D273AAAF49ED5965B4B1D68A5468C6A8C17F51A566C7F81F05B9BB82D46DD4AED152F5DC9BD7872283766638E2028E07064586C3F9C80303BF915ACE8104","signer":"AC1A6E1D8DE5B17D2C6B1293F1CAD3829EEACF38D09311BB3C8E5A880092DE26","version":36866,"type":16718,"maxFee":[0,0],"deadline":[2062190168,23],"namespaceType":0,"duration":[1000,0],"namespaceId":[646738821,2754876907],"name":"xembook"}}
*/

//XEMBook Test Account MIJIN_TEST (http://nfwallet.z31.web.core.windows.net/)
//    [PRIVATE_KEY]：289D5C9F9CF2FA65DB8FAE30F0E1A4AAEFCFA62A1E17ABAA095C6796AE4170C6
//    [PUBLICK_KEY]：FF6E61F2A0440FB09CA7A530C0C64A275ADA3A13F60D1EC916D7F1543D7F0574
//    [ADDRESS]：SCAZJP2UPDEMZJZMY3CCUJQGXY7JMDVJ7CRG6ROT


const nem = require("/home/ec2-user/node_modules/nem2-sdk");



		const transactionHttp = new nem.TransactionHttp('http://13.114.200.132:3000');

	const privateKey = "25B3F54217340F7061D02676C4B928ADB4395EB70A2A52D2A11E2F4AE011B03E";
	const account = nem.Account.createFromPrivateKey(privateKey, nem.NetworkType.MIJIN_TEST);

	const brotherAddress = 'SDG4WG-FS7EQJ-KFQKXM-4IUCQG-PXUW5H-DJVIJB-OXJG';
	const brotherAccount = nem.Address.createFromRawAddress(brotherAddress);

	const sisterAddress = 'SCGPXB-2A7T4I-W5MQCX-FQY4UQ-W5JNU5-F55HGK-HBUN';
	const sisterAccount = nem.Address.createFromRawAddress(sisterAddress);

	const amount = nem.NetworkCurrencyMosaic.createRelative(0); // 10 cat.currency represent 10 000 000 micro cat.currency

	const brotherTransferTransaction = nem.TransferTransaction.create(nem.Deadline.create(), brotherAccount, [amount], nem.PlainMessage.create('payout'), nem.NetworkType.MIJIN_TEST);
	const sisterTransferTransaction  = nem.TransferTransaction.create(nem.Deadline.create(), sisterAccount, [amount], nem.PlainMessage.create('payout'), nem.NetworkType.MIJIN_TEST);

	const aggregateTransaction = nem.AggregateTransaction.createComplete(
	    nem.Deadline.create(),
	    [
			brotherTransferTransaction.toAggregate(account.publicAccount),
	        sisterTransferTransaction.toAggregate(account.publicAccount)
		],
	    nem.NetworkType.MIJIN_TEST,
	    []
	);


//	const networkGenerationHash = process.env.NETWORK_GENERATION_HASH;
//	const signedTransaction = account.sign(aggregateTransaction, networkGenerationHash);
	const signedTransaction = account.sign(aggregateTransaction);
	console.log(signedTransaction.payload);
	console.log(signedTransaction.hash);
	transactionHttp
	    .announce(signedTransaction)
	    .subscribe(x => console.log(x), err => console.error(err));
</script>
</head>
<body>
	<div class="container">

		<h1>040_namespace</h1>
		<div id="items-ctrl">
			<ul>
				<li>[ADDRESS]：<span id="account_address"></span></li>
				<li>[PUBLICK_KEY]：<span id="account_pubkey"></span></li>
			</ul>
		</div>

		<h1>mosaics</h1>
		<div id="items2-ctrl">
			<ul>
			</ul>
		</div>

	</div>
</body>
</html>
